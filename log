SPARK_MAJOR_VERSION is set to 2, using Spark2
/usr/hdp/current/spark2-client/python/lib/pyspark.zip/pyspark/context.py:207: UserWarning: Support for Python 2.6 is deprecated as of Spark 2.0.0
  warnings.warn("Support for Python 2.6 is deprecated as of Spark 2.0.0")
root
 |-- summary: string (nullable = true)
 |-- Age: string (nullable = true)
 |-- CCAvg: string (nullable = true)
 |-- CDAccount: string (nullable = true)
 |-- CreaditCard: string (nullable = true)
 |-- Education: string (nullable = true)
 |-- Experience: string (nullable = true)
 |-- Family: string (nullable = true)
 |-- Income: string (nullable = true)
 |-- Mortgage: string (nullable = true)
 |-- PersonalLoan: string (nullable = true)
 |-- SecuritiesAccount: string (nullable = true)
 |-- online: string (nullable = true)

count non-missing data:
5000
describe Income and Mortgage: 

+-------+-----------------+------------------+
|summary|           Income|          Mortgage|
+-------+-----------------+------------------+
|  count|             5000|              5000|
|   mean|          73.7742|           56.4988|
| stddev|46.03372932108627|101.71380210211213|
|    min|              8.0|                 0|
|    max|            224.0|               635|
+-------+-----------------+------------------+

Correlation of Income and Moartage? 
+----------------------+
|corr(Income, Mortgage)|
+----------------------+
|    0.2068062278031723|
+----------------------+

Correlation of Age and Experience? 
+---------------------+
|corr(Age, Experience)|
+---------------------+
|   0.9942148569683337|
+---------------------+

mean of Income
+-----------+
|avg(Income)|
+-----------+
|    73.7742|
+-----------+

Min and Max of Income
+-----------+-----------+
|max(Income)|min(Income)|
+-----------+-----------+
|      224.0|        8.0|
+-----------+-----------+

how many people have income less than 40k?
+-------------+
|count(Income)|
+-------------+
|         1312|
+-------------+

what is % of people that have income less than 40k?
26.24
what is % of people that have income more than 100k?
24.24
[Stage 34:======================================================>(99 + 1) / 100]                                                                                +----------+-----+
|Experience|count|
+----------+-----+
|        26|  134|
|        29|  124|
|        19|  135|
|         0|   66|
|        -3|    4|
|        22|  124|
|         7|  121|
|        34|  125|
|        32|  154|
|        43|    3|
|        31|  104|
|        39|   85|
|        25|  142|
|         6|  119|
|         9|  147|
|        27|  125|
|        17|  125|
|        41|   43|
|        28|  138|
|        33|  117|
|         5|  146|
|         1|   74|
|        -2|   15|
|        10|  118|
|         3|  129|
|        37|  116|
|        12|  102|
|         8|  119|
|        11|  116|
|        35|  143|
|         2|   85|
|         4|  113|
|        13|  117|
|        36|  114|
|        18|  137|
|        14|  127|
|        21|  113|
|        15|  119|
|        38|   88|
|        30|  126|
|        42|    8|
|        23|  144|
|        20|  148|
|        40|   57|
|        16|  127|
|        -1|   33|
|        24|  131|
+----------+-----+

+---+-----+
|Age|count|
+---+-----+
| 29|  123|
| 26|   78|
| 65|   80|
| 54|  143|
| 34|  134|
| 50|  138|
| 57|  132|
| 43|  149|
| 32|  120|
| 31|  125|
| 39|  133|
| 25|   53|
| 58|  143|
| 27|   91|
| 63|  108|
| 56|  135|
| 51|  129|
| 52|  145|
| 41|  136|
| 28|  103|
| 33|  120|
| 48|  118|
| 67|   12|
| 44|  121|
| 61|  122|
| 37|  106|
| 55|  125|
| 62|  123|
| 49|  115|
| 35|  151|
| 66|   24|
| 36|  107|
| 59|  132|
| 38|  115|
| 42|  126|
| 30|  136|
| 23|   12|
| 46|  127|
| 60|  127|
| 40|  125|
| 64|   78|
| 45|  127|
| 53|  112|
| 47|  113|
| 24|   28|
+---+-----+

+----------+------------------+
|Experience|     avg(Mortgage)|
+----------+------------------+
|        26| 58.09701492537314|
|        29| 48.58870967741935|
|        19|              42.6|
|         0| 41.10606060606061|
|        -3|             36.25|
|        22|55.733870967741936|
|         7| 57.21487603305785|
|        34|            50.184|
|        32| 59.95454545454545|
|        43| 71.66666666666667|
|        31| 54.53846153846154|
|        39|61.917647058823526|
|        25| 69.94366197183099|
|         6|56.378151260504204|
|         9| 53.95238095238095|
|        27|            64.824|
|        17|            61.336|
|        41|19.976744186046513|
|        28| 55.02173913043478|
|        33| 56.31623931623932|
|         5| 61.00684931506849|
|         1| 75.91891891891892|
|        -2|              21.8|
|        10| 57.58474576271186|
|         3| 77.05426356589147|
|        37| 58.12931034482759|
|        12| 54.44117647058823|
|         8| 57.03361344537815|
|        11| 59.91379310344828|
|        35| 49.23076923076923|
|         2| 46.98823529411764|
|         4|51.690265486725664|
|        13| 56.17094017094017|
|        36| 46.86842105263158|
|        18| 58.63503649635037|
|        14|60.653543307086615|
|        21| 49.80530973451327|
|        15|46.226890756302524|
|        38|            63.125|
|        30| 54.42063492063492|
|        42|             44.25|
|        23|50.861111111111114|
|        20| 75.06756756756756|
|        40|  65.0701754385965|
|        16| 54.31496062992126|
|        -1| 54.39393939393939|
|        24|55.916030534351144|
+----------+------------------+

people under 25 years old that could receive over 200k loan
+---+-----+---------+-----------+---------+----------+------+------+--------+------------+-----------------+------+
|Age|CCAvg|CDAccount|CreaditCard|Education|Experience|Family|Income|Mortgage|PersonalLoan|SecuritiesAccount|online|
+---+-----+---------+-----------+---------+----------+------+------+--------+------------+-----------------+------+
| 23|  2.6|        0|          0|        1|        -1|     4|  61.0|     239|           0|                0|     1|
| 23| 6.33|        0|          1|        1|        -1|     1| 149.0|     305|           0|                0|     0|
| 24|  1.6|        0|          0|        3|        -2|     2|  80.0|     238|           0|                0|     0|
+---+-----+---------+-----------+---------+----------+------+------+--------+------------+-----------------+------+

people with experience below 2 that could receive over 200k loan
+---+-----+---------+-----------+---------+----------+------+------+--------+------------+-----------------+------+
|Age|CCAvg|CDAccount|CreaditCard|Education|Experience|Family|Income|Mortgage|PersonalLoan|SecuritiesAccount|online|
+---+-----+---------+-----------+---------+----------+------+------+--------+------------+-----------------+------+
| 25|  2.3|        0|          0|        3|        -1|     4| 109.0|     314|           0|                0|     1|
| 23|  2.6|        0|          0|        1|        -1|     4|  61.0|     239|           0|                0|     1|
| 23| 6.33|        0|          1|        1|        -1|     1| 149.0|     305|           0|                0|     0|
| 25|  0.0|        0|          0|        1|         1|     4|  62.0|     229|           0|                0|     1|
| 25|  2.3|        0|          1|        3|        -1|     4| 101.0|     256|           0|                0|     0|
| 31|  4.0|        0|          0|        3|         1|     4|  60.0|     244|           0|                0|     0|
| 25|  1.8|        0|          1|        2|         0|     2|  88.0|     319|           0|                0|     1|
| 25|  2.0|        0|          0|        1|        -1|     2| 112.0|     241|           0|                0|     1|
| 25|  1.9|        0|          0|        1|         0|     1|  99.0|     323|           0|                0|     0|
| 25|  2.6|        0|          0|        1|         1|     4|  70.0|     218|           0|                0|     1|
| 25|  2.6|        0|          0|        1|         1|     4|  74.0|     204|           0|                0|     0|
| 24|  1.6|        0|          0|        3|        -2|     2|  80.0|     238|           0|                0|     0|
| 25|  1.8|        0|          0|        2|         0|     2|  91.0|     321|           0|                0|     0|
| 27|  5.1|        0|          0|        3|         1|     4| 141.0|     354|           1|                0|     0|
| 26|  0.6|        0|          0|        2|         1|     4|  54.0|     230|           0|                0|     0|
| 27|  2.3|        0|          1|        3|         1|     4| 112.0|     402|           0|                0|     1|
| 26|  4.2|        1|          1|        3|         1|     2| 184.0|     577|           1|                0|     1|
| 26|  4.0|        0|          0|        3|         0|     2| 164.0|     301|           1|                0|     1|
| 27|  1.7|        0|          0|        2|         1|     1| 134.0|     307|           1|                0|     1|
+---+-----+---------+-----------+---------+----------+------+------+--------+------------+-----------------+------+

number of people with high experience rejected to get loan: 
357
number of people with high experience received over 200k: 
44
number of people who received over 200k: 
498
Education and Mortgage
+---------+-----------------+
|Education|    avg(Mortgage)|
+---------+-----------------+
|        1|61.62738549618321|
|        3|54.17854763491006|
|        2|51.31931575196008|
+---------+-----------------+

('Correlation to Mortgage for ', 'Age', -0.012538586859834016)
('Correlation to Mortgage for ', 'CCAvg', 0.10990472333482995)
('Correlation to Mortgage for ', 'CDAccount', 0.089311058241566613)
('Correlation to Mortgage for ', 'CreaditCard', -0.0072309194258932475)
('Correlation to Mortgage for ', 'Education', -0.033327124629950439)
('Correlation to Mortgage for ', 'Experience', -0.010581552418193358)
('Correlation to Mortgage for ', 'Family', -0.020444930961873067)
('Correlation to Mortgage for ', 'Income', 0.20680622780317229)
('Correlation to Mortgage for ', 'Mortgage', 1.0)
('Correlation to Mortgage for ', 'PersonalLoan', 0.14209523632788268)
('Correlation to Mortgage for ', 'SecuritiesAccount', -0.0054109700472621562)
('Correlation to Mortgage for ', 'online', -0.0059948983578711349)
There is no significant correlation between mortgage and other features,

describe Experience and Age: 

+-------+-----------------+------------------+
|summary|       Experience|               Age|
+-------+-----------------+------------------+
|  count|             5000|              5000|
|   mean|          20.1046|           45.3384|
| stddev|11.46795368112056|11.463165630542662|
|    min|               -3|                23|
|    max|               43|                67|
+-------+-----------------+------------------+

('Correlation to Experience for ', 'Age', 0.99421485696833378)
('Correlation to Experience for ', 'CCAvg', -0.050076510577949943)
('Correlation to Experience for ', 'CDAccount', 0.010353331150860682)
('Correlation to Experience for ', 'CreaditCard', 0.0089674473353613931)
('Correlation to Experience for ', 'Education', 0.013151812889482055)
('Correlation to Experience for ', 'Experience', 1.0)
('Correlation to Experience for ', 'Family', -0.052563147136445568)
('Correlation to Experience for ', 'Income', -0.046574177652982052)
('Correlation to Experience for ', 'Mortgage', -0.010581552418193354)
('Correlation to Experience for ', 'PersonalLoan', -0.0074130980767702689)
('Correlation to Experience for ', 'SecuritiesAccount', -0.0012321344074537721)
('Correlation to Experience for ', 'online', 0.013897899571362267)
label and features:
+-----+--------------------+
|label|            features|
+-----+--------------------+
|    1|[1.6,1.0,25.0,4.0...|
|   19|[1.5,1.0,45.0,3.0...|
|   15|[1.0,1.0,39.0,1.0...|
|    9|[2.7,2.0,35.0,1.0...|
|    8|[1.0,2.0,35.0,4.0...|
|   13|[0.4,2.0,37.0,4.0...|
|   27|[1.5,2.0,53.0,2.0...|
|   24|[0.3,3.0,50.0,1.0...|
|   10|[0.6,2.0,35.0,3.0...|
|    9|[8.9,3.0,34.0,1.0...|
+-----+--------------------+
only showing top 10 rows

Coefficients: [-0.0481869896976,-0.371053658441,0.99537212674,-0.0434271984381,0.00191040481121]
Intercept: -24.2736081936
+----+-----+--------------------+
|   r|label|            features|
+----+-----+--------------------+
|-2.0|   -2|[1.6,3.0,24.0,2.0...|
|-1.0|   -1|[0.3,3.0,25.0,3.0...|
|-2.0|   -1|[1.0,1.0,23.0,4.0...|
| 1.0|    0|[1.0,3.0,27.0,4.0...|
| 1.0|    0|[2.1,2.0,26.0,4.0...|
|-1.0|    0|[2.6,3.0,25.0,3.0...|
| 2.0|    1|[0.2,1.0,27.0,2.0...|
| 1.0|    1|[0.6,2.0,26.0,4.0...|
| 0.0|    1|[1.0,2.0,25.0,3.0...|
| 1.0|    1|[1.7,2.0,26.0,4.0...|
| 5.0|    1|[1.75,3.0,31.0,2....|
| 2.0|    1|[1.8,2.0,27.0,4.0...|
| 1.0|    1|[2.3,3.0,27.0,4.0...|
| 1.0|    1|[4.2,3.0,26.0,2.0...|
| 2.0|    1|[5.9,2.0,27.0,1.0...|
| 0.0|    1|[6.33,1.0,25.0,1....|
| 3.0|    2|[0.1,2.0,28.0,1.0...|
| 3.0|    2|[0.1,2.0,28.0,1.0...|
| 3.0|    2|[0.3,2.0,28.0,2.0...|
| 2.0|    2|[0.4,2.0,27.0,3.0...|
+----+-----+--------------------+
only showing top 20 rows

R2_Values: 0.990294171384
MSE_Values: 1.32101368294
RMSE_Values: 1.14935359352
MAE_Values: 0.878375712104
Since the target only has integer numbers let s check its accuracy just like classification!!!
Accuracy of LR_regressor: 0.306748466258
+---+-----+--------------------+
|  r|label|            features|
+---+-----+--------------------+
|6.0|   -2|[1.6,3.0,24.0,2.0...|
|7.0|   -1|[0.3,3.0,25.0,3.0...|
|7.0|   -1|[1.0,1.0,23.0,4.0...|
|5.0|    0|[1.0,3.0,27.0,4.0...|
|7.0|    0|[2.1,2.0,26.0,4.0...|
|8.0|    0|[2.6,3.0,25.0,3.0...|
|6.0|    1|[0.2,1.0,27.0,2.0...|
|5.0|    1|[0.6,2.0,26.0,4.0...|
|7.0|    1|[1.0,2.0,25.0,3.0...|
|5.0|    1|[1.7,2.0,26.0,4.0...|
|6.0|    1|[1.75,3.0,31.0,2....|
|5.0|    1|[1.8,2.0,27.0,4.0...|
|8.0|    1|[2.3,3.0,27.0,4.0...|
|8.0|    1|[4.2,3.0,26.0,2.0...|
|8.0|    1|[5.9,2.0,27.0,1.0...|
|7.0|    1|[6.33,1.0,25.0,1....|
|7.0|    2|[0.1,2.0,28.0,1.0...|
|7.0|    2|[0.1,2.0,28.0,1.0...|
|7.0|    2|[0.3,2.0,28.0,2.0...|
|7.0|    2|[0.4,2.0,27.0,3.0...|
+---+-----+--------------------+
only showing top 20 rows

RF_R2_Values: 0.945452414076
RF_MSE_Values: 7.42420974282
RF_RMSE_Values: 2.72474030741
RF_MAE_Values: 2.13165031622
RF_R2_Values: 0.945452414076
+---+-----+--------------------+
|  r|label|            features|
+---+-----+--------------------+
|6.0|   -2|[1.6,3.0,24.0,2.0...|
|7.0|   -1|[0.3,3.0,25.0,3.0...|
|7.0|   -1|[1.0,1.0,23.0,4.0...|
|5.0|    0|[1.0,3.0,27.0,4.0...|
|7.0|    0|[2.1,2.0,26.0,4.0...|
|8.0|    0|[2.6,3.0,25.0,3.0...|
|6.0|    1|[0.2,1.0,27.0,2.0...|
|5.0|    1|[0.6,2.0,26.0,4.0...|
|7.0|    1|[1.0,2.0,25.0,3.0...|
|5.0|    1|[1.7,2.0,26.0,4.0...|
|6.0|    1|[1.75,3.0,31.0,2....|
|5.0|    1|[1.8,2.0,27.0,4.0...|
|8.0|    1|[2.3,3.0,27.0,4.0...|
|8.0|    1|[4.2,3.0,26.0,2.0...|
|8.0|    1|[5.9,2.0,27.0,1.0...|
|7.0|    1|[6.33,1.0,25.0,1....|
|7.0|    2|[0.1,2.0,28.0,1.0...|
|7.0|    2|[0.1,2.0,28.0,1.0...|
|7.0|    2|[0.3,2.0,28.0,2.0...|
|7.0|    2|[0.4,2.0,27.0,3.0...|
+---+-----+--------------------+
only showing top 20 rows

Adding new column:rounded_prediction
+-----+--------------------+------------------+------------------+
|label|            features|        prediction|rounded_prediction|
+-----+--------------------+------------------+------------------+
|   -2|[1.6,3.0,24.0,2.0...| 5.858993684964342|               6.0|
|   -1|[0.3,3.0,25.0,3.0...| 6.915736758603669|               7.0|
|   -1|[1.0,1.0,23.0,4.0...|7.4774333769657035|               7.0|
|    0|[1.0,3.0,27.0,4.0...| 5.369908417934854|               5.0|
|    0|[2.1,2.0,26.0,4.0...|  6.58302222920157|               7.0|
|    0|[2.6,3.0,25.0,3.0...| 7.742036134070273|               8.0|
|    1|[0.2,1.0,27.0,2.0...|6.4121509519784015|               6.0|
|    1|[0.6,2.0,26.0,4.0...| 5.372760126069921|               5.0|
|    1|[1.0,2.0,25.0,3.0...| 7.377888394841254|               7.0|
|    1|[1.7,2.0,26.0,4.0...| 5.224787223100065|               5.0|
|    1|[1.75,3.0,31.0,2....|6.2771235585554574|               6.0|
|    1|[1.8,2.0,27.0,4.0...| 5.489099635332338|               5.0|
|    1|[2.3,3.0,27.0,4.0...| 7.999572881483291|               8.0|
|    1|[4.2,3.0,26.0,2.0...| 7.575533081569067|               8.0|
|    1|[5.9,2.0,27.0,1.0...| 7.506830684815017|               8.0|
|    1|[6.33,1.0,25.0,1....| 7.404446082748978|               7.0|
|    2|[0.1,2.0,28.0,1.0...| 7.162338861972441|               7.0|
|    2|[0.1,2.0,28.0,1.0...| 7.438831641967688|               7.0|
|    2|[0.3,2.0,28.0,2.0...| 7.057351306612011|               7.0|
|    2|[0.4,2.0,27.0,3.0...| 6.594384158176318|               7.0|
+-----+--------------------+------------------+------------------+
only showing top 20 rows

Since the target only has integer numbers let s check its accuracy just like classification!!!
+-----+--------------------+----------+
|label|            features|prediction|
+-----+--------------------+----------+
|   -2|[1.6,3.0,24.0,2.0...|       6.0|
|   -1|[0.3,3.0,25.0,3.0...|       7.0|
|   -1|[1.0,1.0,23.0,4.0...|       7.0|
|    0|[1.0,3.0,27.0,4.0...|       5.0|
|    0|[2.1,2.0,26.0,4.0...|       7.0|
|    0|[2.6,3.0,25.0,3.0...|       8.0|
|    1|[0.2,1.0,27.0,2.0...|       6.0|
|    1|[0.6,2.0,26.0,4.0...|       5.0|
|    1|[1.0,2.0,25.0,3.0...|       7.0|
|    1|[1.7,2.0,26.0,4.0...|       5.0|
|    1|[1.75,3.0,31.0,2....|       6.0|
|    1|[1.8,2.0,27.0,4.0...|       5.0|
|    1|[2.3,3.0,27.0,4.0...|       8.0|
|    1|[4.2,3.0,26.0,2.0...|       8.0|
|    1|[5.9,2.0,27.0,1.0...|       8.0|
|    1|[6.33,1.0,25.0,1....|       7.0|
|    2|[0.1,2.0,28.0,1.0...|       7.0|
|    2|[0.1,2.0,28.0,1.0...|       7.0|
|    2|[0.3,2.0,28.0,2.0...|       7.0|
|    2|[0.4,2.0,27.0,3.0...|       7.0|
+-----+--------------------+----------+
only showing top 20 rows

Accuracy of RF_regressor: 0.167689161554
